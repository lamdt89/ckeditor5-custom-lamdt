/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x1bb990}from'ckeditor5/src/core';import{getStyles as _0x30fd98,getConverterOptions as _0x3318a7}from'./utils';export default class i extends _0x1bb990{constructor(_0xcf086){super(_0xcf086),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x140b96={}){const _0x497ccf=this['editor'],t=_0x497ccf['t'],_0x1c6ec1=_0x140b96['converterUrl']||'https://docx-converter.cke-cs.com/v1/convert',_0x1b340f=_0x140b96['converterOptions']||{},_0x463eb1=_0x497ccf['plugins']['get']('ExportWord'),_0x2208e8=_0x140b96['token']||_0x463eb1['_token'],_0x1aa772=!0x1!==_0x1b340f['auto_pagination'],_0x56d779=_0x140b96['dataCallback']||(_0x14430a=>_0x14430a['getData']({'pagination':_0x1aa772}));return this['isBusy']=!0x0,this['refresh'](),_0x30fd98(_0x140b96['stylesheets']||['EDITOR_STYLES'])['then'](_0x509768=>{const _0x3e8297=_0x56d779(_0x497ccf),_0x5c1d8d={'html':'<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x497ccf['locale']['contentLanguageDirection']+'\x22>'+_0x3e8297+'</div>','css':_0x509768,'options':{..._0x1b340f,..._0x3318a7(_0x497ccf)}},_0x319fb2={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/docx',..._0x2208e8?{'Authorization':_0x2208e8['value']}:null},'body':JSON['stringify'](_0x5c1d8d)};return window['fetch'](_0x1c6ec1,_0x319fb2)['then'](_0x3dcc34=>{if(0xc8!==_0x3dcc34['status'])throw _0x3dcc34;return _0x3dcc34['blob']();})['then'](_0xc2ab5=>{this['o'](_0xc2ab5,_0x140b96['fileName']||'document.docx');});})['catch'](_0x485793=>{throw _0x497ccf['plugins']['get']('Notification')['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.')),_0x485793;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['o'](_0x45db33,_0x36cc04){const _0x5aa8a7=document['createElement']('a');_0x5aa8a7['href']=window['URL']['createObjectURL'](_0x45db33),_0x5aa8a7['download']=_0x36cc04,_0x5aa8a7['click'](),_0x5aa8a7['remove']();}}